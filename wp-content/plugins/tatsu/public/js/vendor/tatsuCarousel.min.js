!function(t,i,e){"function"==typeof define&&define.amd?define("TatsuCarousel",i):"object"==typeof module&&module.exports?module.exports=i(e):t.TatsuCarousel=i(e)}(window,function(t){var i=t(window),e=function(i){null==i||i.hasClass("slider-initialized")||(t.fn.hasOwnProperty("flickity")?null!=i&&i instanceof t?(this.ele=i,this.prevWidth=window.innerWidth,this.bindMethods(),this.setFlickitySettings(),this.initLazyLoad(),this.initFullscreenSlider(),this.initVariableSlider(),this.initDestroyInMobile(),this.initEvents(),this.adjustArrows(),this.initFlickity()):console.error("Invalid Arg passed to TatsuCarousel"):console.error("Flickity is not added. TatsuCarousel depends on Flickity"))};return e.prototype.initFullscreenSlider=function(){if("1"===this.ele.attr("data-fullscreen")&&(767<window.innerWidth||null==this.ele.attr("data-destroy-in-mobile")&&null==this.ele.attr("data-variable-width"))){var e=this.ele.attr("data-fullscreen-offset"),a=i.height(),s=this.ele.find(".tatsu-carousel-col-inner"),l=0;if("string"==typeof e){e.split(",").forEach(function(i){var e=t(i);0<i.length&&(l+=e.height())})}s.css("height",a-l+"px")}},e.prototype.updateFullscreenSlider=function(){if(767<window.innerWidth||null==this.ele.attr("data-destroy-in-mobile")&&null==this.ele.attr("data-variable-width")){var e=this.ele.attr("data-fullscreen-offset"),a=i.height(),s=this.ele.find(".tatsu-carousel-col-inner"),l=0;if("string"==typeof e){e.split(",").forEach(function(i){var e=t(i);0<i.length&&(l+=e.height())})}s.css("height",a-l+"px")}},e.prototype.adjustArrows=function(){if(!0===this.settings.prevNextButtons&&null!=this.ele.attr("data-outer-arrows")&&t(window).width()>this.ele.width()){var i=(isNaN(parseInt(this.ele.attr("data-gutter")))?0:parseInt(this.ele.attr("data-gutter")))/2+50;this.ele.css({margin:"0 -"+i+"px",padding:"0 50px"})}},e.prototype.bindMethods=function(){this.lazyLoad=this.lazyLoad.bind(this),this.throttledLazyLoad="function"==typeof t.throttle?t.throttle(this.lazyLoad,200):this.lazyLoad,this.flickityInit=this.flickityInit.bind(this),this.updateVariableSlider=this.updateVariableSlider.bind(this),this.updateFullscreenSlider=this.updateFullscreenSlider.bind(this),this.destroyInMobile=this.destroyInMobile.bind(this),this.lazyLoadOnScroll=this.lazyLoadOnScroll.bind(this),this.updatePreviousWidth=this.updatePreviousWidth.bind(this)},e.prototype.setFlickitySettings=function(){this.settings=null;var i={};"1"==this.ele.attr("data-center-mode")&&(i.cellAlign="center"),"1"==this.ele.attr("data-autoplay")&&(i.autoPlay=isNaN(Number(this.ele.attr("data-autoplay-speed")))?3e3:Number(this.ele.attr("data-autoplay-speed"))),"1"==this.ele.attr("data-dots")&&(i.pageDots=!0),"1"===this.ele.attr("data-destroy-in-mobile")&&(i.watchCSS=!0),"1"==this.ele.attr("data-arrows")&&(i.prevNextButtons=!0),"1"==this.ele.attr("data-variable-width")&&(767>=window.innerWidth?i.adaptiveHeight=!0:i.percentPosition=!1),"1"==this.ele.attr("data-infinite")&&(i.wrapAround=!0),"1"==this.ele.attr("data-free-scroll")&&(i.freeScroll=!0),this.settings=t.extend({contain:!0,wrapAround:!1,watchCSS:!1,percentPosition:!0,cellAlign:"left",adaptiveHeight:!1,pageDots:!1,prevNextButtons:!1,autoPlay:!1,freeScroll:!1},i)},e.prototype.getMaxHeight=function(){var i=0;return this.ele.find(".tatsu-carousel-col-inner").each(function(){var e=t(this);i<e.height()&&(i=e.height())}),i},e.prototype.initEqualHeightSlider=function(){if("1"===this.ele.attr("data-equal-height")){var t=this.getMaxHeight();this.ele.find(".tatsu-carousel-col-inner").height(t),this.ele.addClass("tatsu-equal-height-slider")}},e.prototype.initDestroyInMobile=function(){if("1"===this.ele.attr("data-destroy-in-mobile")&&window.innerWidth<768&&"1"===this.ele.attr("data-lazy-load")){var i=this.ele.find(".tatsu-carousel-col-inner");i.css("height","auto"),i.each(function(){var i=t(this),e=i.find(".tatsu-carousel-img").attr("data-aspect-ratio")||1;null!=e&&i.height(i.width()/e)})}},e.prototype.lazyLoadOnScroll=function(){if(0<this.imagesToLazyLoad.length){var i=this.imagesToLazyLoad.parent().filter(function(){return t(this).isVisible(-100)});0<i.length&&this.loadImages(i.find(".tatsu-carousel-img-lazy-load"))}},e.prototype.destroyInMobile=function(){var e=window.innerWidth,a=this.ele.find(".tatsu-carousel-col-inner");this.prevWidth<=767&&e>767?(a.css("height",""),i.off("scroll",this.lazyLoadOnScroll)):this.prevWidth>767&&e<=767?(a.css("width",""),a.each(function(){var i=t(this),e=i.find(".tatsu-carousel-img").attr("data-aspect-ratio")||1;null!=e&&i.height(i.width()/e)}),0<this.imagesToLazyLoad.length&&i.on("scroll",this.lazyLoadOnScroll)):e<768&&(a.each(function(){var i=t(this),e=i.find(".tatsu-carousel-img").attr("data-aspect-ratio")||1;null!=e&&i.height(i.width()/e)}),0<this.imagesToLazyLoad.length&&i.on("scroll",this.lazyLoadOnScroll))},e.prototype.initVariableSlider=function(){if("1"===this.ele.attr("data-variable-width")){var i=this.ele.find(".tatsu-carousel-col-inner"),e=i.height();768<=window.innerWidth?i.each(function(){var i=t(this),a=i.find(".tatsu-carousel-img").attr("data-aspect-ratio")||1;null!=a&&i.width(e*a)}):null==this.ele.attr("data-destroy-in-mobile")&&i.each(function(){var i=t(this),e=i.find(".tatsu-carousel-img").attr("data-aspect-ratio");null!=e&&i.height(i.width()/e)})}},e.prototype.updateVariableSlider=function(){var i=this.ele.find(".tatsu-carousel-col-inner"),a=window.innerWidth,s=i.height();null==this.ele.attr("data-destroy-in-mobile")?(this.prevWidth<=767&&a>767||this.prevWidth>767&&a<=767?(this.destroy(),new e(this.ele)):768<=window.innerWidth?i.each(function(){var i=t(this),e=i.find(".tatsu-carousel-img").attr("data-aspect-ratio");null!=e&&i.width(s*e)}):(i.css("width",""),i.each(function(){var i=t(this),e=i.find(".tatsu-carousel-img").attr("data-aspect-ratio");null!=e&&i.height(i.width()/e)})),this.ele.hasClass("flickity-enabled")&&this.ele.flickity("reposition")):768<=window.innerWidth?(i.each(function(){var i=t(this),e=i.find(".tatsu-carousel-img").attr("data-aspect-ratio");null!=e&&i.width(s*e)}),this.ele.hasClass("flickity-enabled")&&this.ele.flickity("reposition")):null==this.ele.attr("data-lazy-load")&&i.css("width","")},e.prototype.flickityInit=function(){"1"===this.ele.attr("data-lazy-load")&&this.lazyLoad(),this.ele.addClass("tatsu-carousel-initialized")},e.prototype.updatePreviousWidth=function(){this.prevWidth=window.innerWidth},e.prototype.initEvents=function(){this.ele.on("ready.flickity",this.flickityInit),"1"===this.ele.attr("data-lazy-load")&&this.ele.on("scroll.flickity",this.throttledLazyLoad),"1"===this.ele.attr("data-destroy-in-mobile")&&"1"===this.ele.attr("data-lazy-load")&&(768>window.innerWidth&&(i.on("scroll",this.lazyLoadOnScroll),this.lazyLoadOnScroll()),i.on("debouncedresize",this.destroyInMobile)),"1"===this.ele.attr("data-fullscreen")&&i.on("debouncedresize",this.updateFullscreenSlider),"1"===this.ele.attr("data-variable-width")&&i.on("debouncedresize",this.updateVariableSlider),i.on("debouncedresize",this.updatePreviousWidth)},e.prototype.removeEvents=function(){this.ele.off("ready.flickity",this.flickityInit),"1"===this.ele.attr("data-lazy-load")&&this.ele.off("scroll.flickity",this.throttledLazyLoad),"1"===this.ele.attr("data-destroy-in-mobile")&&"1"===this.ele.attr("data-lazy-load")&&(i.off("scroll",this.lazyLoadOnScroll),i.off("debouncedresize",this.destroyInMobile)),"1"===this.ele.attr("data-fullscreen")&&i.off("debouncedresize",this.updateFullscreenSlider),"1"===this.ele.attr("data-variable-width")&&i.off("debouncedresize",this.updateVariableSlider),i.off("debouncedresize",this.updatePreviousWidth)},e.prototype.destroy=function(){this.ele.find(".tatsu-carousel-col-inner").css({height:"",width:""}),this.removeEvents(),this.ele.flickity("destroy"),this.ele.removeClass("tatsu-carousel-initialized")},e.prototype.initLazyLoad=function(){this.imagesToLazyLoad=null,"1"===this.ele.attr("data-lazy-load")&&(this.imagesToLazyLoad=this.ele.find(".tatsu-carousel-img-lazy-load"))},e.prototype.getDoppelgangers=function(i){var e=[],a=t();return 0<this.imagesToLazyLoad.length&&(i.each(function(){e.push(t(this).attr("data-src"))}),this.imagesToLazyLoad.each(function(){var i=t(this);0<i.length&&null==i.attr("src")&&-1<e.indexOf(i.attr("data-src"))&&(a=a.add(i))})),a},e.prototype.loadImages=function(i){var e=this.ele.hasClass("tatsu-carousel-adaptive-image");i.one("load",function(){t(this).addClass("tatsu-carousel-img-lazy-loaded")}).each(function(){var i=t(this);e?i.attr("srcset",i.attr("data-srcset")):i.attr("src",i.attr("data-src"))}),this.imagesToLazyLoad=this.imagesToLazyLoad.not(i),0==this.imagesToLazyLoad.length&&this.ele.off("scroll.flickity",this.throttledLazyLoad)},e.prototype.getVisibleSlides=function(){var i=this.ele.find(".flickity-viewport"),e=i.offset().left,a=e,s=e+i.width();return this.imagesToLazyLoad.filter(function(){var i=t(this).parent(),e=i.offset().left,l=i.offset().left+i.outerWidth(!0);return l>a&&l<=s||e<s&&e>=a})},e.prototype.lazyLoad=function(){if(0<this.imagesToLazyLoad.length){var t=this.getVisibleSlides();null!=t&&0<t.length&&this.loadImages(t)}},e.prototype.initFlickity=function(){this.ele.flickity(this.settings)},e},jQuery);