function getLinksToCompareOnPage(){let e=document.querySelectorAll(".gs-comparison-icon-link-to-compare"),t="";for(let n=0;n<e.length;n++)t+=n+"--"+e[n].getAttribute("data-clear-link")+";";return t}function setNewUrlToLinksOnComparePage(e){let t=document.querySelectorAll(".gs-comparison-icon-link-to-compare");for(let n=0;n<t.length;n++)t[n].setAttribute("href",e[n]);return e}const ajaxSearchContainer=document.querySelectorAll(".comp-ajax-search-wrap");for(let i=0;i<ajaxSearchContainer.length;i++)ajaxSearchContainer[i].addEventListener("click",function(e){if(e.target.classList.contains("wpsm-button-new-compare")||null!==e.target.closest(".wpsm-button-new-compare")){let t=e.target.classList.contains("wpsm-button-new-compare")?e.target:e.target.closest(".wpsm-button-new-compare"),n=t.getAttribute("data-addcompare-id");if(t.classList.add("loading"),t.classList.contains("not-incompare")){let r=new XMLHttpRequest;r.open("POST",gscomparevars.ajax_url,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),r.responseType="json",r.onload=function(){if(this.status>=200&&this.status<400){let e=this.response;if(e.links.length&&setNewUrlToLinksOnComparePage(e.links),e.currentLink.length){var n={Page:"",Url:e.currentLink};history.pushState(n,n.Page,n.Url),document.querySelector(".re-compare-destin").setAttribute("data-compareurl",e.currentLink)}null!=document.querySelector(".gs-compare-icon-counter")&&document.querySelectorAll(".gs-compare-icon-counter").forEach(function(e){let t=parseInt(e.innerHTML);e.innerHTML=t+1}),t.classList.remove("not-incompare","loading"),t.classList.add("comparing")}},r.onerror=function(){};let a=getLinksToCompareOnPage();r.send("action=gscomparecounter&comparenonce="+comparechart.comparenonce+"&compare_count=add&post_id="+n+"&links="+a+"&is_compare_page=1")}else{document.querySelector(".compare-item-"+n).style.opacity=".17";let o=new XMLHttpRequest;o.open("POST",gscomparevars.ajax_url,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),o.responseType="json",o.onload=function(){if(this.status>=200&&this.status<400){let e=this.response;if(e.links.length&&setNewUrlToLinksOnComparePage(e.links),e.currentLink.length){var r={Page:"",Url:e.currentLink};history.pushState(r,r.Page,r.Url),document.querySelector(".re-compare-destin").setAttribute("data-compareurl",e.currentLink)}null!=document.querySelector(".gs-compare-icon-counter")&&document.querySelectorAll(".gs-compare-icon-counter").forEach(function(e){let t=parseInt(e.innerHTML);e.innerHTML=t-1}),t.classList.remove("comparing","loading"),t.classList.add("not-incompare"),document.querySelector(".compare-item-"+n).remove(),document.querySelectorAll(".top_chart_item").length||window.location.reload()}},o.onerror=function(){};let c=getLinksToCompareOnPage();o.send("action=gscomparecounter&comparenonce="+comparechart.comparenonce+"&compare_count=remove&post_id="+n+"&links="+c+"&is_compare_page=1")}}}),ajaxSearchContainer[i].addEventListener("click",function(e){if(e.target.classList.contains("re-compare-destin")||null!==e.target.closest(".re-compare-destin")){let t=e.target.classList.contains("re-compare-destin")?e.target:e.target.closest(".re-compare-destin"),n=t.getAttribute("data-compareurl");""!=n&&(window.location.href=n)}});var dataSearch=document.getElementById("compare_search_data");if(null!=dataSearch){var e=document.getElementById("btn_search"),t=document.getElementById("btn_search_close"),n=document.querySelector(".comp-search"),r=n.querySelector(".comp-search-input"),a=n.querySelector(".comp-ajax-search-wrap");function o(){c()}function c(){e.addEventListener("click",s),t.addEventListener("click",l),document.addEventListener("keyup",function(e){27==e.keyCode&&l(),setTimeout(function(){p(r)},100)})}function s(){n.classList.add("comp-search-open"),setTimeout(function(){r.focus()},600)}function l(){a.classList.remove("comp-ajax-search-open"),a.innerHTML="",n.classList.remove("comp-search-open"),r.blur(),r.value=""}function p(e){var t=dataSearch.dataset.posttype,n=dataSearch.dataset.terms,r=dataSearch.dataset.taxonomy,o=e.value;if(""==o){a.innerHTML="";return}let c=new XMLHttpRequest;c.open("POST",gscomparevars.ajax_url,!0),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),c.responseType="json",c.onload=function(){if(this.status>=200&&this.status<400){let e=this.response;a.innerHTML=e.compare_html,window.innerHeight<700&&a.classList.add("comp-ajax-search-overflow"),a.classList.add("comp-ajax-search-open")}},c.onerror=function(){},c.send("action=add_to_compare_search&search_query="+o+"&posttype="+t+"&terms="+n+"&taxonomy="+r+"&security="+comparechart.comparenonce)}o()}