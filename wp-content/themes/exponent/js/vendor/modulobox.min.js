!function(){var t=window,s=0;t.requestAnimationFrame=t.requestAnimationFrame||t.webkitRequestAnimationFrame,t.requestAnimationFrame||(t.requestAnimationFrame=function(t){var e=(new Date).getTime(),i=Math.max(0,16-(e-s)),t=setTimeout(t,i);return s=e+i,t}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){clearTimeout(t)})}(),function(t,e){"function"==typeof define&&define.amd?define("themeone-utils/utils",e):"object"==typeof module&&module.exports?module.exports=e():t.ThemeoneUtils=e()}(this,function(){"use strict";var t={},e=window.console;return t.error=function(t){void 0!==e&&e.error(t)},t.extend=function(t,e){if(t)if("object"!=typeof t)this.error("Custom options must be an object");else for(var i in e)e.hasOwnProperty(i)&&t.hasOwnProperty(i)&&(e[i]=t[i]);return e},t.prop=function(t){for(var e=this.createEl(),i=["","Webkit","Moz","ms","O"],s=0,o=i.length;s<o;s++){var n=i[s]?i[s]+t.charAt(0).toUpperCase()+t.slice(1):t;if(void 0!==e.style[n])return n}return""},t.cloneObject=function(t){var e,i={};for(e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return i},t.createEl=function(t,e){t=document.createElement(t||"div");return e&&(t.className=e),t},t.camelize=function(t){return t.replace(/-([a-z])/g,function(t){return t[1].toUpperCase()})},t.handleEvents=function(t,e,i,s,o){"object"!=typeof this.event_handlers&&(this.event_handlers={}),this.event_handlers[s]||(this.event_handlers[s]=t[s].bind(t));var n=(o=void 0===o||!!o)?"addEventListener":"removeEventListener";i.forEach(function(t){e[n](t,this.event_handlers[s],!1)}.bind(this))},t.dispatchEvent=function(t,e,i,s,o){i+=e?"."+e:"";o=s?[s].concat(o):[o];t.emitEvent(i,o)},t.throttle=function(i,t){var s=null,o=t;return function(){var t=arguments,e=Date.now();(!s||o<=e-s)&&(s=e,i.apply(this,t))}},t.modulo=function(t,e){return(t+e%t)%t},t.classReg=function(t){return new RegExp("(^|\\s+)"+t+"(\\s+|$)")},t.hasClass=function(t,e){return!!t.className.match(this.classReg(e))},t.addClass=function(t,e){this.hasClass(t,e)||(t.className+=(t.className?" ":"")+e)},t.removeClass=function(t,e){this.hasClass(t,e)&&(t.className=t.className.replace(this.classReg(e)," ").replace(/\s+$/,""))},t.translate=function(t,e,i,s){s=s?" scale("+s+","+s+")":"";t.style[this.browser.trans]=this.browser.gpu?"translate3d("+(e||0)+"px, "+(i||0)+"px, 0)"+s:"translate("+(e||0)+"px, "+(i||0)+"px)"+s},t.browser={trans:t.prop("transform"),gpu:!!t.prop("perspective")},t}),function(t,e){"function"==typeof define&&define.amd?define("themeone-event/event",e):"object"==typeof module&&module.exports?module.exports=e():t.ThemeoneEvent=e()}("undefined"!=typeof window?window:this,function(){"use strict";function t(){}var e=t.prototype;return e.on=function(t,e){if(!t||!e)return null;var i=this._events=this._events||{},t=i[t]=i[t]||[];return-1===t.indexOf(e)&&t.push(e),this},e.off=function(t,e){t=this._events&&this._events[t];if(!t||!t.length)return null;e=t.indexOf(e);return-1!==e&&t.splice(e,1),this},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(!i||!i.length)return null;var s=0,o=i[s];e=e||[];for(var n=this._onceEvents&&this._onceEvents[t];o;){var r=n&&n[o];r&&(this.off(t,o),delete n[o]),o.apply(this,e),o=i[s+=r?0:1]}return this},t}),function(t,e){"function"==typeof define&&define.amd?define("themeone-animate/animate",["themeone-utils/utils","themeone-event/event"],e):"object"==typeof module&&module.exports?module.exports=e(require("themeone-utils"),require("themeone-event")):t.ThemeoneAnimate=e(t.ThemeoneUtils,t.ThemeoneEvent)}(this,function(o,t){"use strict";function e(t,e,i,s){this.element=t,this.defaults=e,this.forces={friction:i||.28,attraction:s||.028},this.resetAnimate()}t=e.prototype=Object.create(t.prototype);return t.updateDrag=function(t){this.move=!0,this.drag=t},t.releaseDrag=function(){this.move=!1},t.animateTo=function(t){this.attraction=t},t.startAnimate=function(){this.move=!0,this.settle=!1,this.restingFrames=0,this.RAF||this.animate()},t.stopAnimate=function(){this.move=!1,this.restingFrames=0,this.RAF&&(cancelAnimationFrame(this.RAF),this.RAF=!1),this.start=o.cloneObject(this.position),this.velocity={x:0,y:0,s:0}},t.resetAnimate=function(){this.stopAnimate(),this.settle=!0,this.drag=o.cloneObject(this.defaults),this.start=o.cloneObject(this.defaults),this.resting=o.cloneObject(this.defaults),this.position=o.cloneObject(this.defaults),this.attraction=o.cloneObject(this.defaults)},t.animate=function(){var e=function(){var t;void 0!==this.position&&(t=o.cloneObject(this.position),this.applyDragForce(),this.applyAttractionForce(),o.dispatchEvent(this,"toanimate","render",this),this.integratePhysics(),this.getRestingPosition(),this.render(100),this.RAF=requestAnimationFrame(e),this.checkSettle(t))}.bind(this);this.RAF=requestAnimationFrame(e)},t.integratePhysics=function(){for(var t in this.position)void 0!==this.position[t]&&(this.position[t]+=this.velocity[t],this.position[t]="s"===t?Math.max(.1,this.position[t]):this.position[t],this.velocity[t]*=this.getFrictionFactor())},t.applyDragForce=function(){if(this.move)for(var t in this.drag){var e;void 0!==this.drag[t]&&(e=this.drag[t]-this.position[t]-this.velocity[t],this.applyForce(t,e))}},t.applyAttractionForce=function(){if(!this.move)for(var t in this.attraction){var e;void 0!==this.attraction[t]&&(e=(this.attraction[t]-this.position[t])*this.forces.attraction,this.applyForce(t,e))}},t.getRestingPosition=function(){for(var t in this.position)void 0!==this.position[t]&&(this.resting[t]=this.position[t]+this.velocity[t]/(1-this.getFrictionFactor()))},t.applyForce=function(t,e){this.velocity[t]+=e},t.getFrictionFactor=function(){return 1-this.forces.friction},t.roundValues=function(t,e){for(var i in t)void 0!==t[i]&&(e="s"===i?100*e:e,t[i]=Math.round(t[i]*e)/e)},t.checkSettle=function(t){if(!this.move){var e,i,s=0;for(e in this.position)void 0!==this.position[e]&&(i="s"===e?1e4:100,Math.round(this.position[e]*i)===Math.round(t[e]*i)&&++s===Object.keys(this.position).length&&this.restingFrames++)}2<this.restingFrames&&(this.stopAnimate(),this.render(1<this.position.s?10:1),this.settle=!0,JSON.stringify(this.start)!==JSON.stringify(this.position)&&o.dispatchEvent(this,"toanimate","settle",this))},t.render=function(t){this.roundValues(this.position,t),o.translate(this.element,this.position.x,this.position.y,this.position.s)},e}),function(t,e){"function"==typeof define&&define.amd?define(["themeone-utils/utils","themeone-event/event","themeone-animate/animate"],e):"object"==typeof exports&&module.exports?module.exports=e(require("themeone-utils"),require("themeone-event"),require("themeone-animate")):t.ModuloBox=e(t.ThemeoneUtils,t.ThemeoneEvent,t.ThemeoneAnimate)}(this,function(v,t,r){"use strict";function e(t){this.options=v.extend(t,a),this.setVar()}var i=0,n={},s="mobx"+("1.4.5"+Math.random()).replace(/\D/g,""),o={uid:0},a={mediaSelector:".mobx",threshold:5,attraction:{slider:.055,slide:.018,thumbs:.016},friction:{slider:.62,slide:.18,thumbs:.22},rightToLeft:!1,loop:3,preload:1,unload:!1,timeToIdle:4e3,history:!1,mouseWheel:!0,contextMenu:!0,scrollBar:!0,fadeIfSettle:!1,controls:["close"],prevNext:!0,prevNextTouch:!1,counterMessage:"[index] / [total]",caption:!0,autoCaption:!1,captionSmallDevice:!0,thumbnails:!0,thumbnailsNav:"basic",thumbnailSizes:{1920:{width:110,height:80,gutter:10},1280:{width:90,height:65,gutter:10},680:{width:70,height:50,gutter:8},480:{width:60,height:44,gutter:5}},spacing:.1,smartResize:!0,overflow:!1,loadError:"Sorry, an error occured while loading the content...",noContent:"Sorry, no content was found!",prevNextKey:!0,scrollToNav:!1,scrollSensitivity:15,zoomTo:"auto",minZoom:1.2,maxZoom:4,doubleTapToZoom:!0,scrollToZoom:!1,pinchToZoom:!0,escapeToClose:!0,scrollToClose:!1,pinchToClose:!0,dragToClose:!0,tapToClose:!0,shareButtons:["facebook","googleplus","twitter","pinterest","linkedin","reddit"],shareText:"Share on",sharedUrl:"deeplink",slideShowInterval:4e3,slideShowAutoPlay:!1,slideShowAutoStop:!1,countTimer:!0,countTimerBg:"rgba(255,255,255,0.25)",countTimerColor:"rgba(255,255,255,0.75)",mediaelement:!1,videoRatio:16/9,videoMaxWidth:1180,videoAutoPlay:!1,videoThumbnail:!1},t=e.prototype=Object.create(t.prototype);return t.init=function(){if(this.GUID)return n[this.GUID];this.GUID=++i,(n[this.GUID]=this).createDOM(),this.setAnimation(),this.getGalleries(),this.openFromQuery()},t.setVar=function(){var t=window,e=document,i=navigator;this.pre="mobx",this.gesture={},this.buttons={},this.slider={},this.slides={},this.cells={},this.states={},this.pointers=[],this.expando=s,this.cache=o,this.dragEvents=this.detectPointerEvents(),this.browser={touchDevice:"ontouchstart"in t||0<i.maxTouchPoints||0<i.msMaxTouchPoints,pushState:"history"in t&&"pushState"in history,fullScreen:this.detectFullScreen(),mouseWheel:"onwheel"in e.createElement("div")?"wheel":void 0!==e.onmousewheel?"mousewheel":"DOMMouseScroll"},this.iframeVideo=this.iframeVideo(),this.socialMedia=this.socialMedia()},t.detectPointerEvents=function(){var t=navigator;return t.pointerEnabled?{start:["pointerdown"],move:["pointermove"],end:["pointerup","pointercancel"]}:t.msPointerEnabled?{start:["MSPointerDown"],move:["MSPointerMove"],end:["MSPointerUp","MSPointerCancel"]}:{start:["mousedown","touchstart"],move:["mousemove","touchmove"],end:["mouseup","mouseleave","touchend","touchcancel"]}},t.detectFullScreen=function(){for(var t=["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"],e=0,i=t.length;e<i;e++)if(document[t[e]])return{element:["fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement"][e],request:["requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen"][e],change:["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"][e],exit:["exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"][e]};var s=this.options.controls,o=s.indexOf("fullScreen");return-1<o&&s.splice(o,1),null},t.iframeVideo=function(){return{youtube:{reg:/(?:www\.)?youtu\.?be(?:\.com)?\/?.*?(?:watch|embed)?(?:.*v=|v\/|watch%3Fv%3D|\/)([\w\-_]+)&?/i,url:"https://www.youtube.com/embed/[ID]?enablejsapi=1&rel=0&autoplay=1",share:"https://www.youtube.com/watch?v=[ID]",poster:"https://img.youtube.com/vi/[ID]/maxresdefault.jpg",thumb:"https://img.youtube.com/vi/[ID]/default.jpg",play:{event:"command",func:"playVideo"},pause:{event:"command",func:"pauseVideo"}},vimeo:{reg:/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|album\/(?:\d+)\/video\/|video\/)?(\d+)(?:[a-zA-Z0-9_\-]+)?/i,url:"https://player.vimeo.com/video/[ID]?autoplay=1&api=1",share:"https://vimeo.com/[ID]",poster:"https://vimeo.com/api/v2/video/[ID].json",play:{event:"command",method:"play"},pause:{event:"command",method:"pause"}},dailymotion:{reg:/(?:www\.)?(?:dailymotion\.com(?:\/embed)(?:\/video|\/hub)|dai\.ly)\/([0-9a-z]+)(?:[\-_0-9a-zA-Z]+#video=(?:[a-zA-Z0-9_\-]+))?/i,url:"https://dailymotion.com/embed/video/[ID]?autoplay=1&api=postMessage",share:"https://www.dailymotion.com/video/[ID]",poster:"https://www.dailymotion.com/thumbnail/video/[ID]",thumb:"https://www.dailymotion.com/thumbnail/video/[ID]",play:"play",pause:"pause"},wistia:{reg:/(?:www\.)?(?:wistia\.(?:com|net)|wi\.st)\/(?:(?:m|medias|projects)|embed\/(?:iframe|playlists))\/([a-zA-Z0-9_\-]+)/i,url:"https://fast.wistia.net/embed/iframe/[ID]?version=3&enablejsapi=1&html5=1&autoplay=1",share:"https://fast.wistia.net/embed/iframe/[ID]",poster:"https://fast.wistia.com/oembed?url=https://home.wistia.com/medias/[ID].json",play:{event:"cmd",method:"play"},pause:{event:"cmd",method:"pause"}}}},t.socialMedia=function(){return{facebook:"https://www.facebook.com/sharer/sharer.php?u=[url]",googleplus:"https://plus.google.com/share?url=[url]",twitter:"https://twitter.com/intent/tweet?text=[text]&url=[url]",pinterest:"https://www.pinterest.com/pin/create/button/?url=[url]&media=[image]&description=[text]",linkedin:"https://www.linkedin.com/shareArticle?url=[url]&mini=true&title=[text]",reddit:"https://www.reddit.com/submit?url=[url]&title=[text]",stumbleupon:"https://www.stumbleupon.com/badge?url=[url]&title=[text]",tumblr:"https://www.tumblr.com/share?v=3&u=[url]&t=[text]",blogger:"https://www.blogger.com/blog_this.pyra?t&u=[url]&n=[text]",buffer:"https://bufferapp.com/add?url=[url]title=[text]",digg:"https://digg.com/submit?url=[url]&title=[text]",evernote:"https://www.evernote.com/clip.action?url=[url]&title=[text]"}},t.createDOM=function(){this.DOM={};for(var t=["holder","overlay","slider","item","item-inner","ui","top-bar","bottom-bar","share-tooltip","counter","caption","caption-inner","thumbs-holder","thumbs-inner"],e=0;e<t.length;e++)this.DOM[v.camelize(t[e])]=v.createEl("div",this.pre+"-"+t[e]);this.appendDOM(this.DOM)},t.appendDOM=function(t){var e=this.options;t.holder.appendChild(t.overlay),t.holder.appendChild(t.slider),t.holder.appendChild(t.ui);for(var i=0;i<5;i++){var s=t.item.cloneNode(!0);s.appendChild(t.itemInner.cloneNode(!0)),t.slider.appendChild(s),this.slides[i]=s}this.slides.length=t.slider.children.length,this.createUI(t,e),t.holder.setAttribute("tabindex",-1),t.holder.setAttribute("aria-hidden",!0),this.DOM.comment=document.createComment(" ModuloBox (v1.4.5) by Themeone "),document.body.appendChild(this.DOM.comment),v.dispatchEvent(this,"modulobox","beforeAppendDOM",t),document.body.appendChild(t.holder),t.topBar.height=t.topBar.clientHeight},t.createUI=function(t,e){var i,s=e.controls.indexOf("share");if(-1<s){for(var o=e.shareButtons,n=o.length;n--;)this.socialMedia.hasOwnProperty(o[n])||o.splice(n,1);o.length?(t.ui.appendChild(t.shareTooltip),e.shareText&&(t.shareTooltip.appendChild(v.createEl("span")).textContent=e.shareText),this.createButtons(o,t.shareTooltip,"shareOn")):e.controls.splice(s,1)}(e.controls.length||e.counterMessage)&&(s=e.controls.indexOf("play"),t.ui.appendChild(t.topBar),e.counterMessage&&t.topBar.appendChild(t.counter),e.slideShowInterval<1&&-1<s&&e.controls.splice(s,1),e.countTimer&&-1<s&&((i=this.DOM.timer=v.createEl("canvas",this.pre+"-timer")).setAttribute("width",48),i.setAttribute("height",48),t.topBar.appendChild(i)),e.controls.length&&(i=e.controls.slice(),this.createButtons(i.reverse(),t.topBar))),(e.caption||e.thumbnails)&&(t.ui.appendChild(t.bottomBar),e.caption&&t.bottomBar.appendChild(t.caption).appendChild(t.captionInner),e.thumbnails&&t.bottomBar.appendChild(t.thumbsHolder).appendChild(t.thumbsInner)),e.prevNext&&this.createButtons(["prev","next"],t.ui)},t.createButtons=function(t,e,i){for(var s=t.length,o=0;o<s;o++){var n=t[o];this.buttons[n]=v.createEl("BUTTON",this.pre+"-"+n.toLowerCase()),e.appendChild(this.buttons[n]),(n&&"function"==typeof this[n]||i)&&(this.buttons[n].event=i||n,this.buttons[n].action=n,"shareOn"===i&&this.buttons[n].setAttribute("title",n.charAt(0).toUpperCase()+n.slice(1)))}},t.getGalleries=function(){this.galleries={};var e=this.options.mediaSelector,t="";if(!e)return!1;try{t=document.querySelectorAll(e)}catch(t){v.error('Your current mediaSelector is not a valid selector: "'+e+'"')}for(var i=0,s=t.length;i<s;i++){var o,n=t[i],r={};r.src="A"===n.tagName?n.getAttribute("href"):null,r.src="IMG"===n.tagName?n.currentSrc||n.src:r.src,r.src=n.getAttribute("data-src")||r.src,r.src&&(this.getMediaAtts(n,r),this.setMediaType(r),r.type&&(this.getMediaThumb(n,r),this.getVideoThumb(r),this.getMediaCaption(n,r),this.setMediaCaption(r),o=this.setGalleryName(n),this.setGalleryFeatures(o,r),r.index=o.length,o.push(r),this.setMediaEvent(n,o.name,r.index)))}v.dispatchEvent(this,"modulobox","updateGalleries",this.galleries)},t.addMedia=function(t,e){if(!e||"object"!=typeof e)return v.error("No media was found to addMedia() in a gallery"),!1;t=""===t?1:t;var i=this.galleries[t];(i=i||(this.galleries[t]=[])).name=t;for(var s=e.length,o=0;o<s;o++){var n=v.cloneObject(e[o]);n.src&&(this.setMediaType(n),this.getVideoThumb(n),this.setMediaCaption(n),this.setGalleryFeatures(i,n),n.index=i.length,i.push(n))}},t.setMediaType=function(t){if(!(-1<["image","video","iframe","HTML"].indexOf(t.type))){t.type=null;var e=t.src||null,i=(e.split(/[?#]/)[0]||e).substr(2+(~-e.lastIndexOf(".")>>>0));if(/(jpg|jpeg|png|bmp|gif|tif|tiff|jfi|jfif|exif|svg)/i.test(i)||-1<["external.xx.fbcdn","drscdn.500px.org"].indexOf(e))t.type="image",t.src=this.getSrc(e);else if(/(mp4|webm|ogv)/i.test(i))t.type="video",t.format="html5";else{var s,o=this.iframeVideo;for(s in o)if(o.hasOwnProperty(s)){var n=e.match(o[s].reg);if(n&&n[1]){var r=o[s];t.type="video",t.format=s,t.share=r.share.replace("[ID]",n[1]),t.src=r.url.replace("[ID]",n[1]),t.pause=r.pause,t.play=r.play,this.options.videoThumbnail&&(t.poster=!t.poster&&r.poster?r.poster.replace("[ID]",n[1]):t.poster,t.thumb=!t.thumb&&r.poster?r.poster.replace("[ID]",n[1]):t.thumb);break}}}}},t.getSrc=function(t){var e=(t||"").split(/,/),i=e.length,s=0;if(i<=1)return t;for(var o=0;o<i;o++){var n=e[o].replace(/\s+/g," ").trim().split(/ /),r=parseFloat(n[1])||0;("w"===(n[1]?n[1].slice(-1):null)&&screen.width>=r&&s<r||!r||0===o)&&(s=r,t=n[0])}return t},t.getMediaAtts=function(t,e){var i=this.options.autoCaption,s=this.getAttr(t),o=t.firstElementChild,o="IMG"!==t.tagName&&o&&"IMG"===o.tagName?o:t;e.type=e.type||s.type||t.getAttribute("data-type"),e.title=s.title||t.getAttribute("data-title")||(i?o.title:null),e.desc=s.desc||t.getAttribute("data-desc")||(i?o.alt:null),e.thumb=s.thumb||t.getAttribute("data-thumb"),e.poster=this.getSrc(s.poster||t.getAttribute("data-poster")),e.width=s.width||t.getAttribute("data-width"),e.height=s.height||t.getAttribute("data-height"),e.title===e.desc&&(e.desc=null)},t.getMediaThumb=function(t,e){t=t.getElementsByTagName("img");!e.thumb&&t[0]&&(e.thumb=t[0].src)},t.getVideoThumb=function(e){var i,t,s;this.options.videoThumbnail&&"video"===e.type&&"html5"!==e.format&&(t=e.poster&&-1<e.poster.indexOf(".json"),i=e.thumb&&-1<e.thumb.indexOf(".json"),(t||i)&&(t=t?e.poster:e.thumb,(s=new XMLHttpRequest).onload=function(t){t=t.target.responseText;(t=(t=JSON.parse(t)).hasOwnProperty(0)?t[0]:t)&&(e.poster=t.thumbnail_large||t.thumbnail_url,e.dom&&(e.dom.style.backgroundImage='url("'+e.poster+'")'),i&&(t=t.thumbnail_small||t.thumbnail_url,"object"==typeof e.thumb?e.thumb.style.backgroundImage='url("'+t+'")':e.thumb=t))}.bind(this),s.open("GET",encodeURI(t),!0),setTimeout(function(){s.send()},0)))},t.getMediaCaption=function(t,e){t=t.nextElementSibling;t&&"FIGCAPTION"===t.tagName&&(t=t.innerHTML,e.title?e.desc||(e.desc=t):e.title=t)},t.setMediaCaption=function(t){t.title=t.title?'<div class="'+this.pre+'-title">'+t.title.trim()+"</div>":"",t.desc=t.desc?'<div class="'+this.pre+'-desc">'+t.desc.trim()+"</div>":"",t.caption=t.title+t.desc},t.getGalleryName=function(t){for(var e=t,i=0;e&&i<2;){if((e=e.parentNode)&&"FIGURE"===e.tagName&&e.parentNode)return e.parentNode.getAttribute("id");i++}},t.setGalleryName=function(t){var e=this.getAttr(t).rel||t.getAttribute("data-rel");e=(e=e||this.getGalleryName(t))||Object.keys(this.galleries).length+1;t=this.galleries[e];return(t=t||(this.galleries[e]=[])).name=e,t},t.setGalleryFeatures=function(t,e){t.zoom||"image"!==e.type||(t.zoom=!0),t.download||"image"!==e.type&&"html5"!==e.format||(t.download=!0)},t.setMediaEvent=function(t,e,i){t.mobxListener&&t.removeEventListener("click",t.mobxListener,!1),t.mobxListener=this.open.bind(this,e,i),t.addEventListener("click",t.mobxListener,!1)},t.open=function(t,e,i){return i&&(i.preventDefault(),i.stopPropagation()),!!this.GUID&&(this.galleries.hasOwnProperty(t)?this.galleries[t].length?this.galleries[t][e]?(v.dispatchEvent(this,"modulobox","beforeOpen",t,e),this.slides.index=e,this.gallery=this.galleries[t],this.gallery.name=t,this.gallery.index=e,this.gallery.loaded=!1,this.removeContent(),this.wrapAround(),this.hideScrollBar(),this.setSlider(),this.setThumbs(),this.setCaption(),this.setMedia(this.options.preload),this.updateMediaInfo(),this.replaceState(),this.setControls(),this.bindEvents(!0),this.show(),this.options.videoAutoPlay&&this.appendVideo(),this.options.slideShowAutoPlay&&-1<this.options.controls.indexOf("play")&&(!this.options.videoAutoPlay||"video"!==this.galleries[t][e].type)&&this.startSlideShow(),this.states.zoom=!1,void(this.states.open=!0)):(v.error("Sorry, no media was found for the current media index: "+e),!1):(v.error("Sorry, no media was found for the current gallery."),!1):(v.error('This gallery name : "'+t+'", does not exist!'),!1))},t.openFromQuery=function(){var t=this.getQueryString(window.location.search);t.hasOwnProperty("guid")&&t.hasOwnProperty("mid")&&!1===this.open(decodeURIComponent(t.guid),decodeURIComponent(t.mid)-1)&&this.replaceState(!0)},t.show=function(){var t=this.DOM.holder,e=this.options.rightToLeft?"add":"remove";t.setAttribute("aria-hidden",!1),v.removeClass(t,this.pre+"-idle"),v.removeClass(t,this.pre+"-panzoom"),v.removeClass(t,this.pre+"-will-close"),v[e+"Class"](t,this.pre+"-rtl"),v.addClass(t,this.pre+"-open")},t.close=function(t){t&&t.preventDefault();var e=this.DOM.holder,i=this.gallery,t=i?i.index:"undefined",i=i?i.name:"undefined";v.dispatchEvent(this,"modulobox","beforeClose",i,t),this.states.fullScreen&&(this.exitFullScreen(),v.removeClass(e,this.pre+"-fullscreen")),this.share(),this.stopSlideShow(),this.pauseVideo(),this.bindEvents(!1),this.replaceState(!0),this.hideScrollBar(),e.setAttribute("aria-hidden",!0),v.removeClass(e,this.pre+"-open"),this.states.open=!1},t.setControls=function(){var t=this.gallery,e=this.options,i=this.buttons;this.DOM.counter&&(this.DOM.counter.style.display=1<t.initialLength?"":"none"),-1<e.controls.indexOf("play")&&(i.play.style.display=1<t.initialLength?"":"none"),-1<e.controls.indexOf("zoom")&&(i.zoom.style.display=t.zoom?"":"none"),-1<e.controls.indexOf("download")&&(i.download.style.display=t.download?"":"none"),this.setPrevNextButtons()},t.setPrevNextButtons=function(){var t;this.options.prevNext&&(t=this.slider.width<680&&this.browser.touchDevice&&!this.options.prevNextTouch,this.buttons.prev.style.display=this.buttons.next.style.display=1<this.gallery.length&&!t?"":"none")},t.setCaption=function(){this.states.caption=!(!this.options.captionSmallDevice&&(this.slider.width<=480||this.slider.height<=480)),this.DOM.caption.style.display=this.states.caption?"":"none"},t.hideScrollBar=function(){var t;this.options.scrollBar||(t="undefined"===(t=this.states.open)||!t,document.body.style.overflow=document.documentElement.style.overflow=t?"hidden":"")},t.bindEvents=function(t){var e,i,s,o=window,n=document,r=this.options,a=this.DOM.holder,h=this.buttons;for(i in h)h.hasOwnProperty(i)&&(s="share"!==i?h[i]:o,v.handleEvents(this,s,["click","touchend"],h[i].event,t));v.handleEvents(this,a,this.dragEvents.start,"touchStart",t),v.handleEvents(this,o,["keydown"],"keyDown",t),v.handleEvents(this,o,["resize","orientationchange"],"resize",t),v.handleEvents(this,a,["transitionend","webkitTransitionEnd","oTransitionEnd","otransitionend","MSTransitionEnd"],"opened"),v.handleEvents(this,a,["touchend"],"disableZoom",t),this.browser.fullScreen&&v.handleEvents(this,n,[this.browser.fullScreen.change],"toggleFullScreen",t),r.history&&v.handleEvents(this,o,["mouseout"],"mouseOut",t),0<r.timeToIdle&&v.handleEvents(this,a,["mousemove"],"mouseMove",t),r.contextMenu||v.handleEvents(this,a,["contextmenu"],"contextMenu",t),r.mouseWheel||this.disableScroll(t),r.scrollToZoom?e="scrollToZoom":r.scrollToNav?e="scrollToNav":r.scrollToClose&&(e="scrollToClose"),e&&v.handleEvents(this,a,[this.browser.mouseWheel],e,t)},t.opened=function(t){var e;"visibility"===t.propertyName&&t.target===this.DOM.holder&&(e=this.gallery.name,t=this.gallery.index,this.states.open?v.dispatchEvent(this,"modulobox","afterOpen",e,t):(this.removeContent(),v.dispatchEvent(this,"modulobox","afterClose",e,t)))},t.mouseOut=function(t){t=t||window.event,t=t.relatedTarget||t.toElement;t&&"HTML"!==t.nodeName||this.replaceState()},t.mouseMove=function(){var t=this.DOM.holder,e=this.pre+"-idle";clearTimeout(this.states.idle),this.states.idle=setTimeout(function(){v.hasClass(t,this.pre+"-open-tooltip")||v.addClass(t,e)}.bind(this),this.options.timeToIdle),v.removeClass(t,e)},t.contextMenu=function(t){var e=t.target,i=e.tagName,e=e.className;("IMG"===i||"VIDEO"===i||-1<e.indexOf(this.pre+"-video")||-1<e.indexOf(this.pre+"-thumb-bg")||e===this.pre+"-thumb")&&t.preventDefault()},t.disableScroll=function(t){var e=document,i=window;i.onwheel=i.ontouchmove=i.onmousewheel=e.onmousewheel=e.onmousewheel=t?function(t){if(this.isEl(t))return(t=t||i.event).preventDefault?(t.preventDefault(),t.returnValue=!1):void 0}.bind(this):null},t.scrollToZoom=function(t){var e,i;!this.isEl(t)||(e=this.normalizeWheel(t))&&e.deltaY&&(i=(i=this.getCell()).attraction.s||i.position.s,i=Math.min(this.options.maxZoom,Math.max(1,i-Math.abs(e.deltaY)/e.deltaY)),this.stopSlideShow(),this.zoomTo(t.clientX,t.clientY,Math.round(10*i)/10))},t.scrollToNav=function(t){!this.isEl(t)||(t=this.normalizeWheel(t))&&t.delta&&this[t.delta*this.isRTL()<0?"prev":"next"]()},t.scrollToClose=function(t){this.isEl(t)&&(t.preventDefault(),this.close())},t.disableZoom=function(t){for(var e=t.target;e;){if(-1<["VIDEO","INPUT","A"].indexOf(e.tagName))return;e=e.parentElement}t.preventDefault()},t.resize=function(t){this.DOM.topBar.height=this.DOM.topBar.clientHeight,this.share(),this.setSlider(),this.setThumbsPosition(),this.setCaption(),this.resizeMedia(),this.updateMediaInfo(),this.setPrevNextButtons(),this.states.zoom=!1,v.removeClass(this.DOM.holder,this.pre+"-panzoom"),v.dispatchEvent(this,"modulobox","resize",t)},t.resizeMedia=function(){for(var t=this.slides,e=0;e<t.length&&this.gallery;e++){var i=this.gallery[t[e].media];i&&(i.dom&&i.dom.loaded||i.dom&&-1<["video","iframe","HTML"].indexOf(i.type))&&this.setMediaSize(i,t[e])}},t.isEl=function(t){t=t.target.className;return-1<(t="string"==typeof t?t:t.baseVal).indexOf(this.pre)},t.isZoomable=function(){var t=this.getMedia(),e=!1;return"image"===t.type&&t.dom&&t.dom.size&&1<t.dom.size.scale&&(e=!0),this.DOM.holder.setAttribute("data-zoom",e),e},t.isDownloadable=function(){var t=this.getMedia(),e=!0;return"image"!==t.type&&"html5"!==t.format&&(e=!1),this.DOM.holder.setAttribute("data-download",e),e},t.isRTL=function(){return this.options.rightToLeft?-1:1},t.addAttr=function(t,e){var i,s;for(s in void 0===t[this.expando]?(i=this.cache.uid++,t[this.expando]=i,this.cache[i]={}):i=t[this.expando],e)e.hasOwnProperty(s)&&(this.cache[i][s]=e[s])},t.getAttr=function(t){return this.cache[t[this.expando]]||{}},t.getThumbHeight=function(){var t=this.thumbs;return 0<t.height&&0<t.width?t.height+2*Math.min(10,t.gutter):0},t.getMedia=function(){var t=this.gallery;return t?t[t.index]:null},t.getCell=function(){var t=this.slides,t=v.modulo(t.length,t.index);return this.cells[t]},t.removeContent=function(){for(var t=0;t<this.slides.length;t++){var e=this.slides[t];this.unloadMedia(e),this.removeMedia(e),e.index=e.media=null}this.removeMedia(this.DOM.thumbsHolder)},t.getQueryString=function(t){var e={};return t.substr(1).split("&").forEach(function(t){t=t.split("="),e[decodeURIComponent(t[0])]=1<t.length?decodeURIComponent(t[1]):""}),e},t.setQueryString=function(t){var e,i,s,o=window.location.search,n=this.getQueryString(o);for(e in o=decodeURI(o),t)t.hasOwnProperty(e)&&(i=encodeURIComponent(t[e]),o=n.hasOwnProperty(e)?(s=n[e],i?o.replace(e+"="+s,e+"="+i):(o=o.replace("&"+e+"="+s,"")).replace(e+"="+s,"")):i?o+(o?"&":"?")+e+"="+i:o.replace(e+"=",""));var r=[location.protocol,"//",location.host,location.pathname].join("");return o=o.substr(1)?o:o.substr(1),encodeURI(r+o)},t.replaceState=function(t){if((this.options.history||t)&&this.browser.pushState&&!this.states.push){var e=window.history.state,i={guid:t?"":this.gallery.name,mid:t?"":v.modulo(this.gallery.initialLength,this.gallery.index)+1};if(!e||e.mid!==i.mid){var s=this.setQueryString(i);try{window.history.replaceState(i,"",s)}catch(t){this.options.history=!1,v.error("SecurityError: A history state object with origin 'null' cannot be created. Please run the script on a server.")}}}this.states.push=!1},t.normalizeWheel=function(t){var e,i,s=t||window.event,o=null;if(t.preventDefault(),"detail"in s&&(i=-1*s.detail),"wheelDelta"in s&&(i=-1*s.wheelDelta),"wheelDeltaY"in s&&(i=-1*s.wheelDeltaY),"wheelDeltaX"in s&&(e=-1*s.wheelDeltaX),"deltaY"in s&&(i=s.deltaY),"deltaX"in s&&(e=-1*s.deltaX),1===s.deltaMode?(e*=40,i*=40):2===s.deltaMode&&(e*=100,i*=100),t=Math.abs(e)>Math.abs(i)?e:i,t=Math.min(100,Math.max(-100,t)),Math.abs(t)<this.options.scrollSensitivity)return this.states.prevDelta=t,o;s=+new Date;return(Math.abs(t)>Math.abs(this.states.prevDelta)||60<s-this.states.prevScroll)&&(o={deltaX:e,deltaY:i,delta:t}),this.states.prevDelta=t,this.states.prevScroll=s,o},t.share=function(t){var e,i,s,o;t&&"VIDEO"===t.target.tagName||(e=this.DOM.holder,i=this.pre+"-open-tooltip",s=t?t.target.className:null,("remove"!=(o=v.hasClass(e,i)?"remove":"add")||s===this.pre+"-share"&&t)&&s!==this.pre+"-share"||("add"==o&&this.setShareTooltip(),v[o+"Class"](e,i)))},t.shareOn=function(t){var e,i=t.target.action,s=this.gallery,o=this.getMedia(),t="image"===o.type?o.src:o.poster,i=this.socialMedia[i];return i?("page"===this.options.sharedUrl?e=[location.protocol,"//",location.host,location.pathname].join(""):"deeplink"===this.options.sharedUrl||-1<["iframe","HTML"].indexOf(o.type)?e=this.setQueryString({guid:s.name,mid:s.index+1}):(e=o.src.replace(/\s/g,"").split(",")[0],"video"===o.type&&"html5"!==o.format&&(e=o.share)),(s=v.createEl("a")).href=t,t=s.href,s.href=e,e=s.href,(s=v.createEl("div")).innerHTML=o.caption,s=(s.textContent||s.innerText).replace(/\s+/g," ").trim()||"",(i=i.replace("[url]",encodeURIComponent(e)).replace("[image]",encodeURIComponent(t)).replace("[text]",encodeURIComponent(s||document.title)))&&(t=Math.round(window.screenX+(window.outerWidth-626)/2),s=Math.round(window.screenY+(window.outerHeight-436)/2),window.open(i,this.pre+"_share","status=0,resizable=1,location=1,toolbar=0,width=626,height=436,top="+s+",left="+t))):v.error("This social share media does not exist"),!1},t.setShareTooltip=function(){var t,e,i,s;-1<this.options.controls.indexOf("share")&&(t="right",s=(e=this.DOM.shareTooltip).clientWidth,(s=(i=this.buttons.share.getBoundingClientRect()).left-s+i.width/2+20)<0&&(t="left",s=i.left+i.width/2-20),e.setAttribute("data-position",t),e.style.top=this.DOM.topBar.height+6+"px",e.style.left=s+"px")},t.download=function(){if(!this.isDownloadable())return!1;var t=this.getMedia().src.replace(/\s/g,"").split(",")[0],e=document.createElement("a"),i=t.split("/");e.href=t,e.download=i.pop().split("?")[0],e.setAttribute("target","_blank"),document.body.appendChild(e),e.click(),document.body.removeChild(e)},t.fullScreen=function(){var t=this.browser.fullScreen.element;document[t]?this.exitFullScreen():this.requestFullScreen()},t.toggleFullScreen=function(){var t=this.DOM.holder,e=document[this.browser.fullScreen.element];e?e===t&&(this.setShareTooltip(),this.states.fullScreen=!0,v.addClass(t,this.pre+"-fullscreen")):(this.share(),this.states.fullScreen=!1,v.removeClass(t,this.pre+"-fullscreen")),this.videoFullScreen()},t.requestFullScreen=function(){var t=this.browser.fullScreen.request;document.documentElement[t]&&this.DOM.holder[t]()},t.exitFullScreen=function(){var t=this.browser.fullScreen.exit;document[t]&&document[t]()},t.play=function(){this.states.play?this.stopSlideShow():this.startSlideShow()},t.startSlideShow=function(){var i=0,s=this.gallery,o=this.options,n=this.states.loop,r=o.slideShowAutoStop,a=Math.max(120,o.slideShowInterval),h=o.countTimer,l=h&&this.DOM.timer?this.DOM.timer.getContext("2d"):null,d=function(t){var e;t=t||+new Date,i=i||t,n&&!r||s.index!==s.initialLength-1?(h&&l&&(e=360*Math.min(1,(t-i+a)/a-1)*(Math.PI/180),l.clearRect(0,0,48,48),this.timerProgress(l,o.countTimerBg,100),this.timerProgress(l,o.countTimerColor,e)),i+a<=t&&(i=t,this.slideTo(this.slides.index+1,!0)),this.timer=requestAnimationFrame(d)):this.stopSlideShow()}.bind(this);v.addClass(this.DOM.holder,this.pre+"-autoplay"),this.states.play=!0,this.timer=requestAnimationFrame(d)},t.stopSlideShow=function(){cancelAnimationFrame(this.timer),v.removeClass(this.DOM.holder,this.pre+"-autoplay"),this.states.play=!1},t.timerProgress=function(t,e,i){var s=1.5*Math.PI;t.strokeStyle=e,t.lineWidth=5,t.beginPath(),t.arc(24,24,18,s,s+i,!1),t.stroke()},t.appendVideo=function(){var t=this.getMedia();if("video"===t.type){if(v.addClass(t.dom,this.pre+"-loading"),v.removeClass(t.dom,this.pre+"-playing"),!t.video){if("html5"===t.format){t.video=v.createEl("video"),t.video.setAttribute("controls",""),t.video.setAttribute("autoplay","");for(var e=t.src.replace(/\s/g,"").split(","),i=0;i<e.length;i++){var s=document.createDocumentFragment(),o=v.createEl("source"),n=/^.+\.([^.]+)$/.exec(e[i]);n&&-1<["mp4","webm","ogv"].indexOf(n[1])&&(o.src=e[i],o.setAttribute("type","video/"+("ogv"===n[1]?"ogg":n[1])),s.appendChild(o)),t.video.appendChild(s)}}else t.format&&(t.video=v.createEl("iframe"),t.video.src=t.src,t.video.setAttribute("frameborder",0),t.video.setAttribute("allowfullscreen",""));t.video.setAttribute("width","100%"),t.video.setAttribute("height","100%")}t.dom.firstChild||(t.dom.appendChild(t.video),"html5"!==t.format&&(t.video.loaded=!1)),this.playVideo(t)}},t.onVideoLoaded=function(t){t.video.loaded=!0,v.removeClass(t.dom,this.pre+"-loading"),v.addClass(t.dom,this.pre+"-playing"),this.cloneVideo(t)},t.cloneVideo=function(t){if(this.states.loop&&"html5"===t.format)for(var e=this.gallery,i=e.length,s=e.initialLength,o=v.modulo(s,t.index),n=0;n<i;n++)v.modulo(s,e[n].index)===o&&e[n].index!==t.index&&(e[n].video=t.video)},t.videoFullScreen=function(){var t=this.getMedia(),e=this.states.fullScreen;"video"===t.type&&"html5"!==t.format&&t.video&&t.video[e?"removeAttribute":"setAttribute"]("allowfullscreen","")},t.playVideo=function(e){var t,i;e.video.loaded?(e.video.getClientRects(),v.removeClass(e.dom,this.pre+"-loading"),v.addClass(e.dom,this.pre+"-playing"),"html5"!==e.format?e.play&&(t="object"==typeof e.play?JSON.stringify(e.play):String(e.play),e.video.contentWindow.postMessage(t,"*")):e.video.error||("function"==typeof MediaElementPlayer&&this.options.mediaelement?((t="VIDEO"===e.video.tagName?e.video:e.video.getElementsByTagName("video")[0]).player&&t.player.setControlsSize(),t.play()):e.video.play())):(i=this,"function"!=typeof MediaElementPlayer||e.play||!this.options.mediaelement||e.video.player?e.video.onload||(e.video.onload=e.video.onerror=e.video.onloadedmetadata=function(){e.dom.firstChild&&(i.onVideoLoaded(e),i.videoFullScreen())},e.video.src=e.src.replace(/\s/g,"").split(",")[0]):new MediaElementPlayer(e.video,{features:["playpause","stop","current","progress","duration","volume","fullscreen"],videoVolume:"horizontal",startVolume:.8,classPrefix:"mejs-",keyActions:[],enableKeyboard:!1,iPadUseNativeControls:!0,iPhoneUseNativeControls:!0,AndroidUseNativeControls:!0,success:function(t){t.addEventListener("loadeddata",function(){var t;e.video=e.dom.lastChild,e.video&&((t=e.video.previousSibling)&&t.parentNode&&t.parentNode.removeChild(t),i.onVideoLoaded(e))},e,!1)},error:function(){i.onVideoLoaded(e)}}))},t.pauseVideo=function(){var t,e=this.getMedia();if(e&&"video"===e.type&&e.video){if(v.removeClass(e.dom,this.pre+"-playing"),!e.video.loaded)return e.dom.innerHTML="",void v.removeClass(e.dom,this.pre+"-loading");"html5"===e.format?("function"!=typeof MediaElementPlayer||!this.options.mediaelement||"VIDEO"===e.video.tagName?e.video:e.video.getElementsByTagName("video")[0]).pause():e.pause&&"dailymotion"!==e.format?(t="object"==typeof e.pause?JSON.stringify(e.pause):String(e.pause),e.video.contentWindow.postMessage(t,"*")):(e.dom.innerHTML="",e.video=null)}},t.insertMedia=function(t,e){t=this.gallery[t];t&&(void 0===t.index&&(t.index=this.gallery.indexOf(t)),this.buildMedia(t),this.appendMedia(t,e),this.loadMedia(t,e))},t.buildMedia=function(t){if(void 0===t.dom){switch(t.type){case"image":t.dom=v.createEl("img",this.pre+"-img"),t.dom.src=t.src;break;case"video":t.dom=v.createEl("div",this.pre+"-video"),t.poster?t.dom.style.backgroundImage='url("'+t.poster+'")':t.dom.loaded=!0;break;case"iframe":t.dom=v.createEl("iframe",this.pre+"-iframe"),t.dom.setAttribute("allowfullscreen",""),t.dom.setAttribute("frameborder",0),t.dom.src=t.src;break;case"HTML":var e=t.src,e=document.querySelector(e);t.dom=v.createEl("div",this.pre+"-html"),t.dom.appendChild(v.createEl("div",this.pre+"-html-inner")),t.dom.firstChild.innerHTML=e?e.innerHTML:null,t.src=e||"",t.dom.loaded=!0}t.type&&t.src||(t.dom=v.createEl("div",this.pre+"-error"),t.dom.textContent=this.options.noContent,t.dom.loaded=!0,t.dom.error=!0,v.dispatchEvent(this,"modulobox","noContent",this.gallery.name,parseInt(t.index,10)))}},t.appendMedia=function(t,e){var i,s,o=this.slides[e],e=o.firstChild;e.childElementCount?(i=e.lastChild,(s=e.firstChild).style.visibility="",t.dom!==i&&e[1===e.childElementCount?"appendChild":"replaceChild"](t.dom,i)):(i=document.createDocumentFragment(),s=v.createEl("div",this.pre+"-loader"),i.appendChild(s),i.appendChild(t.dom),e.appendChild(i)),o.media=t.index},t.loadMedia=function(e,i){var s,t,o;e.dom.loaded?this.showMedia(e,i):(s=this,t="iframe"===e.type?e.dom:e.dom.img=new Image,o=function(){e.dom.error||v.dispatchEvent(s,"modulobox","loadComplete",s.gallery.name,parseInt(e.index,10)),e.dom.loaded="iframe"!==e.type,s.showMedia(e,i)},t.onload=o,t.onerror=function(t){"video"!==e.type&&(e.dom=v.createEl("p",s.pre+"-error"),e.dom.textContent=s.options.loadError,e.dom.error=!0,s.appendMedia(e,i)),v.dispatchEvent(s,"modulobox","loadError",s.gallery.name,parseInt(e.index,10)),o()},t.src="video"===e.type?e.poster:e.src)},t.unloadMedia=function(t){this.gallery&&(t=t.media,(t=this.gallery[t])&&t.dom&&(!this.options.unload||"image"!==t.type||t.dom.loaded||t.dom.complete||t.dom.naturalWidth?"video"===t.type&&"html5"!==t.format&&t.dom.firstChild&&(t.video=null,t.dom.removeChild(t.dom.firstChild)):(t.dom.onload=null,t.dom.onerror=null,t.dom.src="",t.dom.img&&(t.dom.img.onload=null,t.dom.img.onerror=null,t.dom.img.src="",delete t.dom.img),delete t.dom)))},t.removeMedia=function(t){var e=t.firstChild;if(e)for(;e.firstChild;)e.removeChild(e.firstChild)},t.showMedia=function(t,e){var i,s,o=this.slider;this.options.fadeIfSettle&&!o.settle&&!t.dom.revealed||(i=this.slides[e],s=this.gallery,o=i.firstChild.firstChild,e=this.options.preload,this.setMediaSize(t,i),t.index===s.index&&this.isZoomable(),v.addClass(t.dom,this.pre+"-media-loaded"),t.dom.revealed=!0,i.media===t.index&&(o.style.visibility="hidden",s.loaded+=1,s.loaded===e&&e<4&&this.setMedia(e+2)),"iframe"===t.type&&(t.dom.loaded=!1))},t.setMediaSize=function(t,e){var i=t.dom,s=this.slider,o=i.viewport,n=this.getThumbHeight();i.error||(o&&o.width===s.width&&o.height===s.height-n||(this.getCaptionHeight(t,e),this.getMediaSize(t,e),this.fitMediaSize(t,e),this.setMediaOffset(t,e)),(e=i.style).width=i.size.width+"px",e.height=i.size.height+"px",e.left=i.offset.left+"px",e.top=i.offset.top+"px")},t.getCaptionHeight=function(t,e){var i=this.DOM.captionInner,s=this.DOM.topBar.height,o=i.innerHTML,n=this.getThumbHeight();this.options.caption&&this.states.caption&&t.caption?(i.innerHTML=t.caption,i.height=Math.max(s,parseInt(i.clientHeight,10))||s,i.innerHTML=o):i.height=n?0:s,e.width=this.slider.width,e.height=this.slider.height-s-i.height-n},t.getMediaSize=function(t,e){var i=t.dom.size={};switch(t.type){case"image":i.width=t.dom.naturalWidth,i.height=t.dom.naturalHeight;break;case"video":i.width=this.options.videoMaxWidth,i.height=i.width/this.options.videoRatio;break;case"iframe":i.width=t.width||(680<e.width?.8*e.width:e.width),i.height=t.height||e.height;break;case"HTML":i.width=t.width||e.width,i.height=t.height||e.height}},t.fitMediaSize=function(t,e){var i,s,o=this.slider,n=this.options,r=n.zoomTo,a=t.dom.size,h=a.width/a.height,l=this.getThumbHeight(),d=o.width<=480||o.height<=680,u=["video","iframe","HTML"].indexOf(t.type)<0,p=n.smartResize&&d,d=[e.height];(p||n.overflow)&&u&&d.unshift(o.height-l),d.forEach(function(t){(!s||s<o.height-l)&&(i=(i=Math.min(a.width,h*t))>e.width?e.width:Math.round(i),s=(s=Math.ceil(1/h*i))%t<2?t:s)});d=Number((a.width/i).toFixed(3)),r="auto"===r?d:r;t.dom.size={width:i,height:s,scale:d>=n.minZoom?Math.min(n.maxZoom,r):1}},t.setMediaOffset=function(t,e){var i=t.dom.size,s=this.slider,o=this.DOM.topBar.height,n=this.getThumbHeight(),r=0;i.height<=e.height&&(r=o+.5*(e.height-i.height)),t.dom.offset={top:r<0?0:Math.round(r),left:Math.round(.5*(e.width-i.width))},t.dom.viewport={width:s.width,height:s.height-n}},t.mediaViewport=function(t){var e=this.getMedia();if(!e.dom||!e.dom.size)return{top:0,bottom:0,left:0,right:0};var i=e.dom.size,s=e.dom.offset,o=this.slider.height,n=this.slider.width,r=.5*(o-i.height),a=2*s.top-r,e=.5*(r-a),r=e*t-2*e-a,a=i.width/2*(t-1)-s.left,s=i.height*t<=o?e*t:-i.height/2*(t-1)+o-i.height+r,r=i.height*t<=o?e*t:i.height/2*(t-1)+r;return{top:t<=1?0:Math.round(s),bottom:t<=1?0:Math.round(r),left:i.width*t<n?0:Math.round(a),right:i.width*t<n?0:Math.round(-a)}},t.setMedia=function(t){var e,i,s=this.gallery,o=this.slides,n=this.states.loop,r=this.isRTL(),a=Math.round(-r*this.slider.position.x/o.width),h=s.initialLength-1,l=0,d=[];if(!t&&!s.loaded){for(e=t=0;e<o.length;e++)o[e].firstChild.childElementCount&&t++;t+=2,s.loaded=this.options.preload}switch(t){case 0:case 1:d=[0];break;case 2:case 3:d=[-1,0,1];break;default:t=5,d=[-2,-1,0,1,2]}for(n||(i=a+d[t-1],r=a+d[0],l=r<0?-r:0,l=h<i?h-i:l),d=d.map(function(t){return v.modulo(s.length,t+l+a)}),e=0;e<o.length;e++){var u=o[e],p=v.modulo(s.length,u.index);!n&&u.index>p||-1<d.indexOf(p)&&u.media!==p&&(this.unloadMedia(u),this.insertMedia(p,e))}},t.updateMediaInfo=function(){var t=this.slides,e=this.gallery;e.index=v.modulo(e.length,t.index),this.isZoomable(),this.isDownloadable(),this.updateCounter(),this.updateCaption(),this.updateThumbs(),v.dispatchEvent(this,"modulobox","updateMedia",this.getMedia())},t.setThumbs=function(){var t=this.gallery,e=this.thumbs,i=t.initialLength,s=this.options.thumbnails,t=this.DOM.thumbsHolder;if(!s||i<2)return this.DOM.caption.style.bottom=0,t.style.visibility="hidden",t.style.height=0,void(e.height=e.gutter=0);for(var o=this.options.thumbnailSizes,n=Math.max(window.innerWidth,Math.max(screen.width,screen.height)),r=0,a=Object.keys(o).sort(function(t,e){return t-e}),h=0;h<a.length;h++){var l=a[h],d=h===a.length-1?n:Math.min(n,l),d=Math.ceil(d/(o[l].width+o[l].gutter)*2);if(isFinite(d)&&r<d&&(r=d),n<=l)break}var u=document.createDocumentFragment(),i=50<i?Math.min(r,i):i;for(h=0;h<i;h++){var p=v.createEl("div",this.pre+"-thumb");u.appendChild(p)}this.DOM.thumbsInner.appendChild(u),this.setThumbsPosition()},t.thumbClick=function(t){t=t.target;v.hasClass(t,this.pre+"-thumb")||(t=t.parentNode),0<=parseInt(t.index,10)&&this.slideTo(t.index)},t.loadThumb=function(t,e){var i,s=this.gallery[e];s.thumb&&"object"==typeof s.thumb||(i=s.thumb,s.thumb=v.createEl("div",this.pre+"-thumb-bg"),s.thumb.style.backgroundImage=i&&i.indexOf(".json")<0?"url("+i+")":null,"video"===s.type&&(v.addClass(s.thumb,this.pre+"-thumb-video"),v.addClass(s.thumb,this.pre+"-thumb-loaded"))),t[t.firstChild?"replaceChild":"appendChild"](s.thumb,t.firstChild),t.media=e,i&&((e=new Image).onload=function(){v.addClass(s.thumb,this.pre+"-thumb-loaded")}.bind(this),e.src=i)},t.updateThumbs=function(){var t,e=this.gallery;!this.options.thumbnails||e.initialLength<2||(t=this.thumbs,e=this.getThumbPosition(t),t.stopAnimate(),e!==t.position.x?Math.abs(e-t.position.x)>50*t.size?(this.DOM.thumbsHolder.style.visibility="hidden",t.position.x=e,v.translate(this.DOM.thumbsInner,e,0),this.renderThumbs(t),this.DOM.thumbsHolder.style.visibility=""):(t.startAnimate(),t.releaseDrag(),t.animateTo({x:e})):this.shiftThumbs(t))},t.updateCaption=function(){var t,e;this.options.caption&&(t=this.getMedia().caption||"",(e=this.DOM.captionInner).innerHTML!==t&&(e.innerHTML=t))},t.updateCounter=function(){var t,e;this.options.counterMessage&&(e=(t=this.gallery).initialLength,t=v.modulo(e,t.index),t=this.options.counterMessage.replace("[index]",t+1).replace("[total]",e),(e=this.DOM.counter).textContent!==t&&(e.textContent=t))},t.wrapAround=function(){var t=this.options.loop,e=this.gallery,i=e.length;if(e.initialLength||(e.initialLength=i),this.states.loop=!!(t&&t<=i),this.states.loop&&i<this.slides.length)for(var s=Math.ceil(this.slides.length/i)*i-i,o=0;o<s;o++){var n=i+o;e[n]=v.cloneObject(e[v.modulo(i,o)]),e[n].index=n}},t.setSlider=function(){var t=this.slider,e=this.slides;this.setSizes(t,e),this.setSliderPosition(t,e),this.setSlidesPositions(e),this.DOM.overlay.style.opacity=1},t.setSizes=function(t,e){t.width=document.body.clientWidth,t.height=window.innerHeight,e.width=t.width+Math.round(t.width*this.options.spacing)},t.setSlidesPositions=function(t){for(var e=0;e<t.length;e++)t[e].position=null,this.setCellPosition(e);this.shiftSlides()},t.setThumbsPosition=function(){if(this.options.thumbnails&&!(this.gallery.initialLength<2)){for(var t,e=this.thumbs,i=this.slider,s=this.DOM.thumbsHolder,o=this.DOM.thumbsInner,n=this.options.thumbnailSizes,r=this.options.rightToLeft,a=Object.keys(n).sort(function(t,e){return e-t}),h=Math.max.apply(null,a),l=window.innerWidth,d=0;d<a.length;d++)l<=(t=Number(a[d]))&&(h=t);e.width=Number(n[h].width),e.gutter=Number(n[h].gutter),e.height=Number(n[h].height),e.size=e.width+e.gutter,e.length=this.gallery.initialLength;var u=e.length*e.size;e.bound={left:0,right:u>i.width?i.width-u:0},r&&(e.bound.right=u>i.width?i.width-e.size:u-e.size,e.bound.left=u-e.size),"centered"===this.options.thumbnailsNav&&(e.bound={left:u>i.width?Math.floor(.5*i.width-.5*e.size):Math.floor(.5*u-.5*e.size),right:u>i.width?Math.ceil(.5*i.width-u+.5*e.size):-Math.ceil(.5*u-.5*e.size)},r&&(e.bound.right=e.bound.left,e.bound.left=e.bound.left+u-e.size)),e.resetAnimate();n=this.getThumbPosition(e);e.position.x=n,v.translate(o,n,0);n=this.getThumbHeight();s.style.visibility=n?"":"hidden",s.style.height=n?n+"px":"",o.style.height=n?e.height+Math.min(10,e.gutter)+"px":"",o.style.width=e.length*e.size+"px",o.style.right=u>i.width&&r?"auto":""}},t.getThumbPosition=function(t){var e=this.slider,i=this.gallery,s=this.options.thumbnailsNav,o=this.isRTL(),n=o<0?"right":"left",i=v.modulo(i.initialLength,i.index),e=.5*e.width-.5*t.size,i=t.bound[n]-i*t.size*o,i=t.bound[n]?i+(o<0&&"centered"!==s?-e:0):i+e;return Math.max(t.bound.right,Math.min(t.bound.left,i))},t.setCellPosition=function(t){this.cells[t].resetAnimate(),v.translate(this.slides[t].children[0],0,0,1)},t.setSliderPosition=function(t,e){var i=this.options.rightToLeft,s=-e.index*e.width,s=i?-s:s;t.resetAnimate(),t.position.x=t.attraction.x=s,t.bound={left:0,right:-(this.gallery.length-1)*e.width},i&&(t.bound.left=-t.bound.right,t.bound.right=0),v.translate(this.DOM.slider,s,0)},t.setAnimation=function(){var t=this.DOM.slider,e=this.options.friction,i=this.options.attraction;this.slider=new r(t,{x:0,y:0},Math.min(Math.max(e.slider,0),1),Math.min(Math.max(i.slider,0),1)),this.slider.on("settle.toanimate",this.settleSider.bind(this)),this.slider.on("render.toanimate",this.renderSlider.bind(this));for(var s=t.children,o=s.length,n=0;n<o;n++)this.cells[n]=new r(s[n].children[0],{x:0,y:0,s:1},Math.min(Math.max(e.slide,0),1),Math.min(Math.max(i.slide,0),1)),this.cells[n].on("settle.toanimate",this.settleCell.bind(this)),this.cells[n].on("render.toanimate",this.renderCell.bind(this));this.thumbs=new r(this.DOM.thumbsInner,{x:0},Math.min(Math.max(e.thumbs,0),1),Math.min(Math.max(i.thumbs,0),1)),this.thumbs.on("settle.toanimate",this.settleThumbs.bind(this)),this.thumbs.on("render.toanimate",this.renderThumbs.bind(this))},t.settleSider=function(t){if(v.dispatchEvent(this,"modulobox","sliderSettled",t.position),this.states.open&&(this.setMedia(),this.replaceState()),this.options.fadeIfSettle)for(var e=this.slides,i=0;i<e.length;i++){var s=e[i].media;(s=this.gallery[s]).dom.loaded&&this.showMedia(s,i)}},t.settleCell=function(t){var e=this.gesture;e.closeBy&&v.dispatchEvent(this,"modulobox","panYSettled",null,t.position),(e.closeBy&&!1===e.canClose||!e.closeBy)&&v.dispatchEvent(this,"modulobox","panZoomSettled",null,t.position)},t.settleThumbs=function(t){v.dispatchEvent(this,"modulobox","thumbsSettled",null,t.position)},t.renderSlider=function(t){this.shiftSlides();var e=this.isRTL(),i=this.gallery.initialLength,t=-e*t.position.x/this.slides.width,t=v.modulo(i,t),i=(i-.5<t?0:t)/(i-1);v.dispatchEvent(this,"modulobox","sliderProgress",null,Math.min(1,Math.max(0,i)))},t.renderCell=function(t){var e;this.willClose(t),("panY"===this.gesture.type||this.gesture.closeBy||"dragSlider"===this.gesture.type&&0!==t.position.y)&&(e=1-Math.abs(t.position.y)/(.5*this.slider.height),v.dispatchEvent(this,"modulobox","panYProgress",null,e)),"panY"!==this.gesture.type&&1!==t.position.s&&(e=t.position.s,v.dispatchEvent(this,"modulobox","panZoomProgress",null,e))},t.renderThumbs=function(t){this.shiftThumbs(t);t=t.bound.left!==t.bound.right?(t.bound.left-t.position.x)/(t.bound.left-t.bound.right):0;v.dispatchEvent(this,"modulobox","thumbsProgress",null,t)},t.touchStart=function(t){var e=t.target,i=e.tagName,s=e.className;3!==t.which&&e!==this.buttons.play&&this.stopSlideShow(),3===t.which||!this.isEl(t)||-1<["BUTTON","VIDEO","INPUT","A"].indexOf(i)||("IMG"===i&&1<this.gallery.length&&v.addClass(this.DOM.holder,this.pre+"-dragging"),t.preventDefault(),v.hasClass(this.DOM.holder,this.pre+"-open-tooltip")||(this.pointers.length||(this.gesture.canClose=void 0,v.handleEvents(this,window,this.dragEvents.move,"touchMove"),v.handleEvents(this,window,this.dragEvents.end,"touchEnd")),this.addPointer(t),s.indexOf("-thumb")<0?(this.slider.stopAnimate(),s=this.getCell(),Math.round(100*s.position.s)/100==1&&2!==this.pointers.length&&!this.gesture.closeBy||s.stopAnimate()):this.thumbs.stopAnimate(),this.gestures("start")))},t.touchMove=function(t){this.updatePointer(t);var e,i=this.gesture,s=this.pointers.length,o=this.isSliderSettle();this.switchPointers(),this.gestures("move"),i.type?(this[i.type](t),v.dispatchEvent(this,"modulobox",i.type+"Move",t,i),i.move=!0):(2===s&&o||Math.abs(i.dx)>this.options.threshold||Math.abs(i.dy)>this.options.threshold)&&(i.sx+=i.dx,i.sy+=i.dy,i.canZoom=this.isZoomable(),i.closeBy=!1,i.type=!(Math.abs(i.dx)<Math.abs(i.dy)/2)&&"dragSlider",i.type=this.options.dragToClose&&!i.type&&o?"panY":i.type,i.type=(this.options.pinchToZoom||this.states.zoom)&&i.canZoom&&o&&(2===s||this.states.zoom)?"panZoom":i.type,i.type=this.options.pinchToClose&&i.scale<1&&o&&2===s?"panZoom":i.type,i.type=-1<t.target.className.indexOf("-thumb")?"dragThumbs":i.type,"dragSlider"===i.type&&this.setMedia(),-1<["dragSlider","dragThumbs"].indexOf(i.type)&&((e=this.getCell()).startAnimate(),e.releaseDrag(),e.animateTo({x:0,y:0,s:1})),"dragSlider"!==i.type&&(s=this.slider,e=this.slides,-this.isRTL()*s.position.x!=e.index*e.width&&(s.startAnimate(),s.releaseDrag())),i.type&&(this.pauseVideo(),v.dispatchEvent(this,"modulobox",i.type+"Start",t,i),(1<this.gallery.length||"dragSlider"!==i.type)&&v.addClass(this.DOM.holder,this.pre+"-dragging")))},t.touchEnd=function(t){if(this.deletePointer(t),!this.pointers.length){if(v.removeClass(this.DOM.holder,this.pre+"-dragging"),v.handleEvents(this,window,this.dragEvents.move,"touchMove",!1),v.handleEvents(this,window,this.dragEvents.end,"touchEnd",!1),this.isSliderSettle()){var e=t.target.className;if(v.hasClass(t.target,this.pre+"-video"))this.appendVideo();else if(this.options.tapToClose&&!this.states.zoom&&(e===this.pre+"-item-inner"||e===this.pre+"-top-bar")&&Math.abs(this.gesture.dx)<this.options.threshold)return void this.close();"IMG"===t.target.tagName&&this.doubleTap(t)}this.options.thumbnails&&!this.gesture.move&&this.thumbClick(t);e=this.gesture.type+"End";this.gesture.type&&"function"==typeof this[e]&&(this[e](t),v.dispatchEvent(this,"modulobox",e,t,this.gesture)),this.gesture.type=this.gesture.move=!1,this.states.open&&((t=this.getCell()).settle||(t.startAnimate(),t.releaseDrag()),(t=this.slider).settle||(t.startAnimate(),t.releaseDrag()))}},t.switchPointers=function(){var t;"panZoom"===this.gesture.type&&1===this.pointers.length&&0!==this.gesture.distance&&((t=this.getCell()).stopAnimate(),t.startAnimate(),this.gesture.move=!1,this.gestures("start"),this.gestures("move"))},t.doubleTap=function(t){t.preventDefault();var e=this.mapPointer(t),i=e[0].clientX,t=e[0].clientY;void 0!==this.tap&&+new Date-this.tap.delay<350&&Math.abs(this.tap.deltaX-i)<30&&Math.abs(this.tap.deltaY-t)<30?(this.states.tapIdle&&clearTimeout(this.states.tapIdle),this.options.doubleTapToZoom&&this.zoomTo(i,t),this.tap=void 0):(this.browser.touchDevice&&this.options.timeToIdle&&!this.states.idle&&(this.states.tapIdle=setTimeout(function(){var t=v.hasClass(this.DOM.holder,this.pre+"-idle")?"remove":"add";v[t+"Class"](this.DOM.holder,this.pre+"-idle")}.bind(this),350)),this.tap={delay:+new Date,deltaX:e[0].clientX,deltaY:e[0].clientY})},t.isSliderSettle=function(){if(this.gesture.type)return!1;var t=this.isRTL(),e=this.slides,i=e.width;return Math.abs(t*this.slider.position.x+e.index*i)/i*100<=3},t.mapPointer=function(t){return t.touches?t.changedTouches:[t]},t.addPointer=function(t){for(var e,i,s=this.mapPointer(t),o=0;o<s.length;o++)this.pointers.length<2&&-1===["dragSlider","panY","dragThumbs"].indexOf(this.gesture.type)&&(i=void 0!==(e=s[o]).pointerId?e.pointerId:e.identifier,this.getPointer(i)||(this.pointers[this.pointers.length]={id:i,x:Math.round(e.clientX),y:Math.round(e.clientY)}))},t.updatePointer=function(t){for(var e=this.mapPointer(t),i=0;i<e.length;i++){var s=e[i],o=void 0!==s.pointerId?s.pointerId:s.identifier,o=this.getPointer(o);o&&(o.x=Math.round(s.clientX),o.y=Math.round(s.clientY))}},t.deletePointer=function(t){for(var e=this.mapPointer(t),i=0;i<e.length;i++)for(var s=e[i],o=void 0!==s.pointerId?s.pointerId:s.identifier,n=0;n<this.pointers.length;n++)this.pointers[n].id===o&&this.pointers.splice(n,1)},t.getPointer=function(t){for(var e in this.pointers)if(this.pointers[e].id===t)return this.pointers[e];return null},t.gestures=function(t){var e,i,s=this.gesture,o=this.pointers;o.length&&(s.direction=s.x?o[0].x>s.x?1:-1:0,s.x=o[0].x,s.y=o[0].y,2===o.length&&(e=o[1].x,o=o[1].y,i=this.getDistance([s.x,s.y],[e,o]),s.x=s.x-(s.x-e)/2,s.y=s.y-(s.y-o)/2),"start"===t?(s.dx=0,s.dy=0,s.sx=s.x,s.sy=s.y,s.distance=i||0):(s.dx=s.x-s.sx,s.dy=s.y-s.sy,s.scale=i&&s.distance?i/s.distance:1))},t.getDistance=function(t,e){var i=e[0]-t[0],t=e[1]-t[1];return Math.sqrt(i*i+t*t)},t.panY=function(){var t=this.getCell();t.startAnimate(),t.updateDrag({x:t.position.x,y:t.start.y+this.gesture.dy,s:t.position.s})},t.panYEnd=function(){var t,e=this.getCell(),i=this.slider.height,s=e.resting.y;1-Math.abs(s)/(.5*i)<.8&&(t=Math.abs(s)<.5*i?Math.abs(s)/s*i*.5:s,this.close(),e.animateTo({x:0,y:t,s:t?e.resting.s:1}),e.startAnimate(),e.releaseDrag())},t.panZoom=function(){var t=this.getCell(),e=this.gesture,i=this.mediaViewport(t.position.s),s=this.options.pinchToClose&&e.canClose?.1:.6,o=Math.min(1.5*this.options.maxZoom,Math.max(s,t.start.s*e.scale)),n=t.start.x+e.dx,r=t.start.y+e.dy,a=e.sx-.5*this.slider.width,s=e.sy-.5*this.slider.height;e.canZoom&&(this.options.pinchToZoom||this.states.zoom)||(o=Math.min(1,o)),!this.options.pinchToZoom&&this.states.zoom&&(o=t.position.s),e.move||1!==this.pointers.length||(t.start.x+=n>i.left?n-i.left:n<i.right?n-i.right:0,t.start.y+=r>i.bottom?r-i.bottom:r<i.top?r-i.top:0),n=e.dx+a+(t.start.x-a)*(o/t.start.s),r=e.dy+s+(t.start.y-s)*(o/t.start.s),1===this.pointers.length&&(n=n>i.left?.5*(n+i.left):n<i.right?.5*(n+i.right):n,r=r>i.bottom?.5*(r+i.bottom):r<i.top?.5*(r+i.top):r),t.startAnimate(),t.updateDrag({x:n,y:r,s:o}),this.updateZoom(o)},t.panZoomEnd=function(){var t,e,i=this.getCell(),s=this.gesture,o=i.resting.s>this.options.maxZoom?this.options.maxZoom:i.resting.s<1?1:i.resting.s,n=this.mediaViewport(o);e=Math.round(10*i.resting.s)/10>this.options.maxZoom?(t=s.distance?s.sx-.5*this.slider.width:0,e=s.distance?s.sy-.5*this.slider.height:0,t=s.dx+t+(i.start.x-t)*(o/i.start.s),e=s.dy+e+(i.start.y-e)*(o/i.start.s),t=t>n.left?n.left:t<n.right?n.right:t,e>n.bottom?n.bottom:e<n.top?n.top:e):(t=i.resting.x>n.left?n.left:i.resting.x<n.right?n.right:void 0,i.resting.y>n.bottom?n.bottom:i.resting.y<n.top?n.top:void 0),this.options.pinchToClose&&i.resting.s<.8&&s.canClose&&(o=i.resting.s<.3?i.resting.s:.15,t=i.resting.x,e=i.resting.y,this.close()),i.animateTo({x:t,y:e,s:o!==i.resting.s?o:void 0}),i.startAnimate(),i.releaseDrag(),this.updateZoom(i.resting.s)},t.dragThumbs=function(){var t=this.thumbs,e=t.bound,i=t.start.x+this.gesture.dx;this.gesture.move||(t.start.x+=i>e.left?i-e.left:i<e.right?i-e.right:0,i=t.start.x+this.gesture.dx),i=i>e.left?.5*(i+e.left):i<e.right?.5*(i+e.right):i,t.startAnimate(),t.attraction.x=void 0,t.updateDrag({x:i})},t.dragThumbsEnd=function(){var t=this.thumbs,e=t.bound,i=t.resting.x;(i=i>e.left?e.left:i<e.right?e.right:i)!==t.resting.x&&t.animateTo({x:i}),t.startAnimate(),t.releaseDrag()},t.dragSlider=function(){var t,e,i;1!==this.gallery.length&&(e=(t=this.slider).start.x+this.gesture.dx,this.states.loop||(i=t.bound,this.gesture.move||(t.start.x+=e>i.left?e-i.left:e<i.right?e-i.right:0,e=t.start.x+this.gesture.dx),e=e>i.left?.5*(e+i.left):e<i.right?.5*(e+i.right):e),t.startAnimate(),t.updateDrag({x:e}))},t.dragSliderEnd=function(){var t,e,i,s,o,n;1!==this.gallery.length&&(t=this.slider,i=(e=this.slides).index,s=this.isRTL(),o=t.resting.x,n=t.position.x,this.getRestingIndex(n,o),i!==e.index&&this.updateMediaInfo(),this.slider.animateTo({x:-s*e.index*e.width,y:void 0,s:void 0}),t.startAnimate(),t.releaseDrag())},t.getRestingIndex=function(t,e){var i=this.gesture.direction,s=this.gallery,o=this.slides,n=this.gesture.dx,r=this.isRTL(),a=Math.round(-r*t/o.width),t=Math.abs(e-t);Math.abs(n)<.5*o.width&&t&&(0<n&&0<i?a-=+r:n<0&&i<0&&(a+=+r));a=Math.max(-1,Math.min(1,a-o.index));!this.states.loop&&(s.index+a<0||s.index+a>s.length-1)||(o.index+=a)},t.shiftSlides=function(){var t=this.slides,e=this.gallery,i=this.states.loop,s=this.isRTL(),o=s*Math.round(-this.slider.position.x/t.width)-2,n=o+5;!i&&n>e.initialLength-1&&(n=(o=e.initialLength-5)+5),!i&&o<0&&(o=0,n=5);for(var r=o;r<n;r++){var a=s*r*t.width,h=t[v.modulo(t.length,r)];h.index===r&&h.position===a||(h.index=r,h.position=a,h.style.left=a+"px")}this.states.open&&this.setMedia(3)},t.shiftThumbs=function(t){var e=this.DOM.thumbsInner.children,i=this.slider,s=this.gallery,o=this.isRTL(),n=e.length,r=v.modulo(s.initialLength,s.index),a=t.size*n*.5,h=Math.round((-o*t.position.x+o*a*.5)/t.size),a=Math.max(0,h-Math.floor(n/2)),l=a+n,h=.5*i.width,d=t.position.x+h,u=t.position.x-i.width-h;l>s.initialLength&&(a=(l=s.initialLength)-n),l===s.initialLength-1&&a-l<n&&(a=s.initialLength-n);for(var p=a;p<l;p++){var m=e[v.modulo(n,p)],c=o*p*t.size+.5*t.gutter,g=this.pre+"-active-thumb",f=v.hasClass(m,g);m.index===p&&m.position===c||(m.index=p,m.position=c,m.style.left=c+"px"),this.setThumbSize(m,t),-m.position<=d&&-m.position>=u&&m.media!==p&&this.loadThumb(m,p),f&&r!==p?v.removeClass(m,g):f||r!==p||v.addClass(m,g)}},t.setThumbSize=function(t,e){t.width===e.width&&t.height===e.height&&t.gutter===e.gutter||(t.width=e.width,t.height=e.height,t.gutter=e.gutter,t.style.width=e.width+"px",t.style.height=e.height+"px")},t.willClose=function(t){var e=this.DOM.overlay.style.opacity,i=this.gesture.canClose,s=this.gesture.type,o=this.gesture.closeBy,n="panZoom"===s||"panZoom"===o,o="panY"===s||"panY"===o;1.1<t.position.s&&void 0===i?this.gesture.canClose=!1:t.position.s<1&&void 0===i&&(this.gesture.canClose=!0),this.options.pinchToClose&&n&&this.gesture.canClose?(e=t.position.s,this.gesture.closeBy="panZoom"):o?(e=1-Math.abs(t.position.y)/(.5*this.slider.height),this.gesture.closeBy="panY"):e&&e<1&&(e=1,this.gesture.closeBy=!1),e=e?Math.max(0,Math.min(1,e)):1,v[(e<=.8||!e?"add":"remove")+"Class"](this.DOM.holder,this.pre+"-will-close"),this.DOM.overlay.style.opacity=e},t.prev=v.throttle(function(){this.gesture.move||this.slideTo(this.slides.index-+this.isRTL())},120),t.next=v.throttle(function(){this.gesture.move||this.slideTo(this.slides.index+ +this.isRTL())},120),t.slideTo=function(t,e){var i=this.slides,s=this.gallery,o=this.DOM.slider,n=this.isRTL(),r=s.initialLength,a=v.modulo(r,t),h=a-v.modulo(r,s.index),s=r-Math.abs(h);!this.states.loop&&(t<0||t>this.gallery.initialLength-1)||(this.states.loop&&s<3&&2*s<r&&(h=h<0?s:-s),a===t&&(t=i.index+h),(h=t-i.index)&&(this.states.zoom&&this.zoom(),this.pauseVideo(),this.share(),e||this.stopSlideShow(),i.index=t,e=this.slider,2<Math.abs(h)&&(v.addClass(o,this.pre+"-hide"),this.setSliderPosition(e,i),this.setSlidesPositions(i),h=n*i.width*Math.min(2,Math.abs(h))*Math.abs(h)/h,e.position.x=e.attraction.x=e.position.x+h,v.translate(o,e.position.x,0),o.getClientRects()),this.updateMediaInfo(),v.removeClass(o,this.pre+"-hide"),e.startAnimate(),e.releaseDrag(),e.animateTo({x:-n*t*i.width,y:0,s:void 0})))},t.keyDown=function(t){var e=t.keyCode,i=this.options;if(i.prevNextKey&&(37===e?this.prev(t):39===e&&this.next(t)),27===e&&i.escapeToClose&&this.close(),!i.mouseWheel&&-1<[32,33,34,35,36,38,40].indexOf(e))return t.preventDefault(),!1},t.zoom=function(){this.zoomTo()},t.zoomTo=function(t,e,i){var s,o;!this.isSliderSettle()||!this.isZoomable()&&1<i||(this.gesture.closeBy=!1,o=this.getMedia(),i=i||(this.states.zoom?1:o.dom.size.scale),s=this.getCell(),o=this.mediaViewport(i),t=t?t-.5*this.slider.width:0,e=e?e-.5*this.slider.height:0,t=1<i?Math.ceil(t+(s.position.x-t)*(i/s.position.s)):0,e=1<i?Math.ceil(e+(s.position.y-e)*(i/s.position.s)):0,s.startAnimate(),s.releaseDrag(),s.animateTo({x:t>o.left?o.left:t<o.right?o.right:t,y:e>o.bottom?o.bottom:e<o.top?o.top:e,s:i}),this.updateZoom(i))},t.updateZoom=function(t){this.states.zoom=1<t,v[this.states.zoom?"addClass":"removeClass"](this.DOM.holder,this.pre+"-panzoom")},t.destroy=function(){if(this.GUID){this.states.open&&this.close();var t=this.options.mediaSelector,e="";try{e=document.querySelectorAll(t)}catch(t){}for(var i=0,s=e.length;i<s;i++){var o=e[i];o.mobxListener&&o.removeEventListener("click",o.mobxListener,!1)}for(this.bindEvents(!1),this.slider.resetAnimate(),i=0;i<this.slides.length;i++)this.cells[i].resetAnimate();this.thumbs&&this.thumbs.resetAnimate(),this.DOM.holder.parentNode.removeChild(this.DOM.holder),this.DOM.comment.parentNode.removeChild(this.DOM.comment),delete n[this.GUID],delete this.GUID}},"undefined"!=typeof jQuery&&(jQuery.ModuloBox=function(t){return new e(t)}),e});